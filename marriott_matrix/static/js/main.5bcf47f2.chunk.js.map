{"version":3,"sources":["AvailableRooms.tsx","utils.tsx","CheckOutRow.tsx","PriceGrid.tsx","matrixReducer.ts","Slider.tsx","Filters.tsx","MarriottMatrix.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["AvailableRooms","props","hotels","useMemo","byName","Map","pricePoints","forEach","pricePoint","currentBest","get","hotelName","undefined","cheapestRate","pricePerNight","set","corporateRate","bookingLink","Array","from","values","sort","a","b","react_default","createElement","dialog","className","classNames","Classes","DARK","isOpen","visible","title","onClose","selectedSquare","dates","checkIn","checkOut","map","d","moment","format","renderTitle","htmlTable","striped","interactive","hotel","key","onClick","openBookingLink","price","concat","window","open","formatDate","date","dayOfWeek","DEFAULT_HOTELS","datesToKey","stay","getStayLength","diff","pricePointIsWithinStayLengthRange","stayLengthRange","length","hotelIsWithinDistance","distanceRange","distance","datesAreChronological","first","second","dateIsInRange","dateStr","range","stringToDate","getPriceFromGrid","grid","PricePointMap","_Map","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","apply","arguments","inherits","createClass","value","prototype","call","list","Error","push","wrapNativeSuper","toDate","CheckOutRow","checkInDates","getPrice","onClickCell","onMouseEnter","onHover","onMouseLeave","offHover","clickable","active","activeCheckIn","tint","shouldTint","getColorClass","renderDate","multiline","_formatDate","Fragment","getPricePercentile","percentile","TINT_AFTER_CLICKED","PriceGrid","_useState","useState","_useState2","slicedToArray","setSelectedSquare","_useState3","_useState4","hoveredSquare","setHoveredSquare","useBlueprintTable","table","defaultColumnWidth","enableRowResizing","enableColumnResizing","enableMultipleSelection","loadingOptions","TableLoadingOption","CELLS","COLUMN_HEADERS","ROW_HEADERS","renderMode","RenderMode","BATCH","rowHeaderCellRenderer","rowIndex","rowHeaderCell","numRows","defaultRowHeight","column","checkOutDates","name","cellRenderer","renderColumns","bordered","condensed","CheckOutRow_CheckOutRow","onSelectSquare","getActiveCheckIn","shouldTintSquare","onHoverSquare","priceStr","toLocaleString","cell","stayOverlaps","selected","overlapper","overlapsSelected","thisSquare","rank","size","matrixReducer","state","action","type","objectSpread","byDates","pricePointsByDates","square","Slider","localValue","setLocalValue","labelSuffix","spreadableProps","objectWithoutProperties","rangeSlider","assign","labelRenderer","label","labelStepSize","stepSize","onChange","onRelease","Filters","ImmutableSet","bucketedHotels","ceiling","expandedBuckets","setExpandedBuckets","Slider_Slider","min","max","maxDistance","selectedDistanceRange","onChangeDistanceRange","selectedStayLengthRange","maxStayLength","onChangeStayLengthRange","dateRangeInput","shortcuts","toDateString","parseDate","minDate","dateRange","maxDate","onChangeDateRange","bucket","react","expanded","has","getKeyFromBucket","toggleBucketExpansion","icon","IconNames","CARET_DOWN","CARET_RIGHT","Infinity","floor","renderBucketTitle","items","some","TICK","intent","Intent","SUCCESS","collapse","outOfRange","tooltip","content","disabled","controls","checked","onChangeHotelSelection","labelElement","remove","add","sortDates","MarriottMatrix","viewingAvailableRooms","setViewingAvailableRooms","_useReducer","useReducer","hotelToPricePoints","selectedHotelNames","Set","addPricePoint","includes","byHotel","ImmutableList","createInitialState","_useReducer2","dispatch","_useMemo","buckets","nameToHotel","anyHotelsSelected","array","_useMemo2","useCallback","_useMemo3","stayDates","_pricePoint$stayDates","stayLength","Math","_useMemo4","last","setDistanceRange","_useState5","_useState6","setDateRange","_useState7","_useState8","setStayLengthRange","useEffect","datesToPricePoints","priceGridMap","addPricePointToGrid","soldOut","_pricePoint$stayDates2","_i","_arr","pricePointWithPrice","datesString","bestPriceForStay","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","entries","Symbol","iterator","next","done","_ref3","_ref2","hotelForPricePoint","err","return","sortedPrices","toConsumableArray","_ref4","_ref5","_ref6","_ref7","mapWithRanks","_ref8","i","_ref9","dateString","Filters_Filters","renderFilters","PriceGrid_PriceGrid","renderTable","AvailableRooms_AvailableRooms","getPricePointsForStay","processScrapedPricePoint","_pricePoint$dates","booking_link","propertyCodeMatch","match","corporate_rate","price_per_night","sold_out","App","innerWidth","width","setWidth","handleResize","addEventListener","removeEventListener","useWindowWidth","MarriottMatrix_MarriottMatrix","prices","Boolean","location","hostname","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.5bcf47f2.chunk.js","sourcesContent":["import React, { useMemo } from \"react\";\nimport { PricePointWithPrice, StayDates } from \"./types\";\nimport \"./AvailableRooms.scss\";\nimport { HTMLTable, Dialog, Classes } from \"@blueprintjs/core\";\nimport moment from \"moment\";\nimport classNames from \"classnames\";\n\ninterface Props {\n  visible: boolean;\n  pricePoints?: PricePointWithPrice[];\n  selectedSquare?: StayDates;\n  onClose: () => void;\n}\n\ninterface HotelPrice {\n  hotelName: string;\n  cheapestRate?: number;\n  corporateRate: boolean;\n  bookingLink?: string;\n}\n\nfunction getRate(price: HotelPrice) {\n  if (price.cheapestRate === null) {\n    return \"No Rate Available\";\n  }\n  return `$${price.cheapestRate} (${\n    price.corporateRate ? \"Corporate Rate\" : \"Regular Rate\"\n  })`;\n}\n\nexport const AvailableRooms: React.FC<Props> = (props: Props) => {\n  const hotels = useMemo(() => {\n    const byName = new Map<string, HotelPrice>();\n    if (props.pricePoints) {\n      props.pricePoints.forEach(pricePoint => {\n        const currentBest = byName.get(pricePoint.hotelName);\n        if (\n          currentBest === undefined ||\n          currentBest.cheapestRate === undefined ||\n          (pricePoint.pricePerNight !== undefined &&\n            pricePoint.pricePerNight < currentBest.cheapestRate)\n        ) {\n          byName.set(pricePoint.hotelName, {\n            hotelName: pricePoint.hotelName,\n            cheapestRate: pricePoint.pricePerNight,\n            corporateRate: pricePoint.corporateRate,\n            bookingLink: pricePoint.bookingLink\n          });\n        }\n      });\n    }\n    return Array.from(byName.values()).sort((a, b) => {\n      if (a.cheapestRate === null || a.cheapestRate === undefined) {\n        return 1;\n      } else if (b.cheapestRate === null || b.cheapestRate === undefined) {\n        return -1;\n      }\n      return a.cheapestRate - b.cheapestRate;\n    });\n  }, [props]);\n\n  return (\n    <Dialog\n      className={classNames(\"available-rooms\", Classes.DARK)}\n      isOpen={props.visible}\n      title={\"Available Rooms\"}\n      onClose={props.onClose}\n    >\n      {renderTitle()}\n      <p>Click on an option to book</p>\n      <div className=\"table-container\">\n        <HTMLTable className=\"table\" striped interactive>\n          <tbody>\n            {hotels.map(hotel => (\n              <tr key={hotel.hotelName} onClick={openBookingLink(hotel)}>\n                <td>{hotel.hotelName}</td>\n                <td>{getRate(hotel)}</td>\n              </tr>\n            ))}\n          </tbody>\n        </HTMLTable>\n      </div>\n    </Dialog>\n  );\n\n  function renderTitle() {\n    if (!props.selectedSquare) {\n      return null;\n    }\n    const dates = [\n      props.selectedSquare.checkIn,\n      props.selectedSquare.checkOut\n    ].map(d => moment(d).format(\"dddd, MMMM D, YYYY\"));\n\n    return (\n      <h3>\n        {dates[0]}\n        <span className=\"space\" />\n        —\n        <span className=\"space\" />\n        {dates[1]}\n      </h3>\n    );\n  }\n\n  function openBookingLink(hotel: HotelPrice) {\n    return () => {\n      if (hotel.bookingLink) {\n        window.open(hotel.bookingLink, \"_blank\");\n      }\n    };\n  }\n};\n","import moment from \"moment\";\nimport { PricePoint, Hotel, PriceGridData, StayDates } from \"./types\";\nimport { NumberRange } from \"@blueprintjs/core\";\nimport { DateRange } from \"@blueprintjs/datetime\";\n\nexport function formatDate(date: string) {\n  return {\n    dayOfWeek: moment(date).format(\"ddd\"),\n    date: moment(date).format(\"M/D\")\n  };\n}\n\nexport const DEFAULT_HOTELS: string[] = [\n  \"The Ritz-Carlton Georgetown, Washington, D.C.\",\n  \"The Westin Georgetown, Washington D.C.\",\n  \"Washington Marriott Georgetown\",\n  \"The Ritz-Carlton, Washington, DC\",\n  \"The Mayflower Hotel, Autograph Collection\",\n  \"The Westin Georgetown, Washington D.C.\"\n];\n\nexport function datesToKey(stay: StayDates): string {\n  return `${stay.checkIn}-${stay.checkOut}`;\n}\n\nexport function getLast<T>(array: T[]): T {\n  return array[array.length - 1];\n}\n\nexport function getStayLength(stay: StayDates) {\n  return moment(stay.checkOut).diff(moment(stay.checkIn), \"days\");\n}\n\nexport function pricePointIsWithinStayLengthRange(\n  stay: StayDates,\n  stayLengthRange: NumberRange\n) {\n  const length = getStayLength(stay);\n  return length >= stayLengthRange[0] && length <= stayLengthRange[1];\n}\n\nexport function hotelIsWithinDistance(\n  hotel: Hotel,\n  distanceRange: NumberRange\n) {\n  return (\n    hotel.distance >= distanceRange[0] && hotel.distance <= distanceRange[1]\n  );\n}\n\nexport function datesAreChronological(first?: Date, second?: Date): boolean {\n  if (!first || !second) {\n    return true;\n  }\n  return moment(second).diff(moment(first)) >= 0;\n}\n\nexport function dateIsInRange(dateStr: string, range: DateRange) {\n  const date = stringToDate(dateStr);\n  return (\n    datesAreChronological(range[0], date) &&\n    datesAreChronological(date, range[1])\n  );\n}\n\nexport function getPriceFromGrid(\n  grid: PriceGridData | undefined,\n  stay: StayDates\n) {\n  if (grid) {\n    const key = datesToKey(stay);\n    const pricePoint = grid.map.get(key);\n    return pricePoint && pricePoint.pricePerNight;\n  }\n}\n\nexport class PricePointMap<V extends PricePoint> extends Map<string, V[]> {\n  public addPricePoint(key: string, pricePoint: V) {\n    if (this.get(key) === undefined) {\n      super.set(key, []);\n    }\n    const list = super.get(key);\n    if (list === undefined) {\n      throw Error(`No list for key: ${key} in PricePointMap`);\n    }\n    list.push(pricePoint);\n    return this;\n  }\n\n  public set(): this {\n    throw Error(\n      \"Calling set() in a PricePointMap is disallowed. Use addPricePoint instead.\"\n    );\n  }\n}\n\nexport function stringToDate(date: string) {\n  return moment(date).toDate();\n}\n\nexport function getBucketCeiling(value: number) {\n  if (value <= 1) {\n    return 1;\n  } else if (value <= 2) {\n    return 2;\n  } else if (value <= 5) {\n    return 5;\n  } else if (value <= 10) {\n    return 10;\n  } else {\n    return Infinity;\n  }\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport \"./CheckOutRow.scss\";\nimport { formatDate } from \"./utils\";\n\ninterface Props {\n  checkInDates: string[];\n  checkOut?: string;\n  activeCheckIn?: string;\n  getPrice?: (checkOut: string) => number | undefined;\n  shouldTint?: (checkIn: string) => boolean;\n  onClick?: (checkIn: string) => void;\n  getPricePercentile?: (checkIn: string) => number | undefined;\n  onHover?: (checkIn: string) => void;\n  offHover?: (checkIn: string) => void;\n}\n\nexport const CheckOutRow: React.FC<Props> = (props: Props) => {\n  return (\n    <tr>\n      {props.checkInDates.map(checkIn => {\n        if (props.getPrice && props.checkOut) {\n          const price = props.getPrice && props.getPrice(checkIn);\n          return (\n            <td\n              key={checkIn}\n              onClick={onClickCell(checkIn)}\n              onMouseEnter={() => props.onHover && props.onHover(checkIn)}\n              onMouseLeave={() => props.offHover && props.offHover(checkIn)}\n              className={classNames(\n                {\n                  clickable: price !== undefined,\n                  active: props.activeCheckIn === checkIn,\n                  tint: props.shouldTint && props.shouldTint(checkIn)\n                },\n                checkIn < props.checkOut ? getColorClass(checkIn) : \"impossible\"\n              )}\n            >\n              {price !== undefined && <p>{`$${price}`}</p>}\n            </td>\n          );\n        } else {\n          return (\n            <th\n              key={checkIn}\n              className={classNames(\n                \"checkin-date\",\n                props.shouldTint && props.shouldTint(checkIn) && \"tint\"\n              )}\n            >\n              {renderDate(checkIn, true)}\n            </th>\n          );\n        }\n      })}\n      {props.checkOut && (\n        <th className=\"checkout-date\">{renderDate(props.checkOut, false)}</th>\n      )}\n    </tr>\n  );\n\n  function renderDate(dateStr: string, multiline: boolean) {\n    const { dayOfWeek, date } = formatDate(dateStr);\n    if (multiline) {\n      return (\n        <>\n          <p>{dayOfWeek}</p>\n          <p>{date}</p>\n        </>\n      );\n    } else {\n      return (\n        <p>\n          {dayOfWeek}, {date}\n        </p>\n      );\n    }\n  }\n\n  function onClickCell(checkIn: string) {\n    return () => props.onClick && props.onClick(checkIn);\n  }\n\n  function getColorClass(checkIn: string) {\n    if (!props.getPricePercentile) {\n      return;\n    }\n    const percentile = props.getPricePercentile(checkIn);\n    if (percentile === undefined) {\n      return \"no-price\";\n    }\n    if (percentile >= 0.9) {\n      return \"cost-1\";\n    } else if (percentile > 0.7) {\n      return \"cost-2\";\n    } else if (percentile > 0.3) {\n      return \"cost-3\";\n    } else if (percentile > 0.1) {\n      return \"cost-4\";\n    } else {\n      return \"cost-5\";\n    }\n  }\n};\n","import React, { useState } from \"react\";\nimport {\n  Cell,\n  Column,\n  Table,\n  TableLoadingOption,\n  RenderMode,\n  RowHeaderCell\n} from \"@blueprintjs/table\";\nimport { PriceGridData, StayDates } from \"./types\";\nimport \"./PriceGrid.scss\";\nimport { formatDate, getPriceFromGrid, datesToKey } from \"./utils\";\nimport { HTMLTable } from \"@blueprintjs/core\";\nimport { CheckOutRow } from \"./CheckOutRow\";\nimport { DateRange } from \"@blueprintjs/datetime\";\n\ninterface Props {\n  grid?: PriceGridData;\n  useBlueprintTable: boolean;\n  onSelectSquare: (square: StayDates) => void;\n  dateRange: DateRange;\n}\n\nconst TINT_AFTER_CLICKED = false;\n\nexport const PriceGrid: React.FC<Props> = (props: Props) => {\n  const [selectedSquare, setSelectedSquare] = useState<StayDates | undefined>(\n    undefined\n  );\n  const [hoveredSquare, setHoveredSquare] = useState<StayDates | undefined>(\n    undefined\n  );\n\n  if (props.useBlueprintTable) {\n    return (\n      <Table\n        defaultColumnWidth={85}\n        enableRowResizing={false}\n        enableColumnResizing={false}\n        enableMultipleSelection={false}\n        loadingOptions={\n          !props.grid\n            ? [\n                TableLoadingOption.CELLS,\n                TableLoadingOption.COLUMN_HEADERS,\n                TableLoadingOption.ROW_HEADERS\n              ]\n            : []\n        }\n        renderMode={RenderMode.BATCH}\n        rowHeaderCellRenderer={renderRowHeader}\n        numRows={props.grid ? props.grid.checkInDates.length : 25}\n        defaultRowHeight={25}\n      >\n        {renderColumns()}\n      </Table>\n    );\n  } else {\n    if (!props.grid) {\n      return null;\n    }\n    return (\n      <div className=\"grid\">\n        <div>\n          <p>\n            <p className=\"dates-label\">Check in</p>\n          </p>\n          <HTMLTable bordered condensed className=\"table-header\">\n            <thead>\n              <CheckOutRow checkInDates={props.grid.checkInDates} />\n            </thead>\n          </HTMLTable>\n          <div className=\"table-container\">\n            <HTMLTable bordered condensed className=\"html-table\">\n              <tbody>{props.grid.checkOutDates.map(renderRow)}</tbody>\n            </HTMLTable>\n          </div>\n        </div>\n        <p className=\"dates-label checkout-text\">Check out</p>\n      </div>\n    );\n  }\n\n  function renderRow(checkOut: string) {\n    if (!props.grid) {\n      return null;\n    }\n    return (\n      <CheckOutRow\n        key={checkOut}\n        checkOut={checkOut}\n        checkInDates={props.grid.checkInDates}\n        getPrice={getPrice(checkOut)}\n        onClick={onSelectSquare(checkOut)}\n        activeCheckIn={getActiveCheckIn(checkOut)}\n        getPricePercentile={getPricePercentile(checkOut)}\n        shouldTint={shouldTintSquare(checkOut)}\n        onHover={onHoverSquare(checkOut)}\n        offHover={onUnhoverSquare()}\n      />\n    );\n  }\n\n  function renderRowHeader(rowIndex: number) {\n    if (props.grid) {\n      return (\n        <RowHeaderCell className=\"row-header\">\n          {formatDate(props.grid.checkInDates[rowIndex]).date}\n        </RowHeaderCell>\n      );\n    }\n    return <RowHeaderCell>{rowIndex}</RowHeaderCell>;\n  }\n\n  function renderColumns() {\n    if (!props.grid) {\n      return <Column />;\n    }\n    return props.grid.checkOutDates.map(checkOut => {\n      return (\n        <Column\n          key={checkOut}\n          name={formatDate(checkOut).date}\n          cellRenderer={cellRenderer(checkOut)}\n        />\n      );\n    });\n  }\n\n  function cellRenderer(checkOut: string) {\n    return (rowIndex: number) => {\n      let priceStr = \"\";\n      if (props.grid) {\n        const checkIn = props.grid.checkInDates[rowIndex];\n        const price = getPriceFromGrid(props.grid, { checkIn, checkOut });\n        if (price !== undefined) {\n          priceStr = `$${price.toLocaleString()}`;\n        }\n      }\n      return <Cell>{priceStr}</Cell>;\n    };\n  }\n\n  function getPrice(checkOut: string) {\n    return (checkIn: string) => {\n      return getPriceFromGrid(props.grid, { checkIn, checkOut });\n    };\n  }\n\n  function onSelectSquare(checkOut: string) {\n    return (checkIn: string) => {\n      if (getPriceFromGrid(props.grid, { checkIn, checkOut }) === undefined) {\n        return;\n      }\n      setSelectedSquare({ checkIn, checkOut });\n      props.onSelectSquare && props.onSelectSquare({ checkIn, checkOut });\n    };\n  }\n\n  function onHoverSquare(checkOut: string) {\n    return (checkIn: string) => setHoveredSquare({ checkIn, checkOut });\n  }\n\n  function onUnhoverSquare() {\n    return () => setHoveredSquare(undefined);\n  }\n\n  function stayOverlaps(selected: StayDates, overlapper: StayDates) {\n    if (selected.checkIn === overlapper.checkIn) {\n      return selected.checkOut >= overlapper.checkOut;\n    }\n    if (selected.checkOut === overlapper.checkOut) {\n      return selected.checkIn <= overlapper.checkIn;\n    }\n    return false;\n  }\n\n  function shouldTintSquare(checkOut: string) {\n    return (checkIn: string): boolean => {\n      const overlapsSelected =\n        selectedSquare && stayOverlaps(selectedSquare, { checkIn, checkOut });\n      const overlapsHovered =\n        hoveredSquare && stayOverlaps(hoveredSquare, { checkIn, checkOut });\n\n      return overlapsHovered || (TINT_AFTER_CLICKED && overlapsSelected);\n    };\n  }\n\n  function getActiveCheckIn(checkOut: string) {\n    if (!TINT_AFTER_CLICKED) {\n      return;\n    }\n    if (!selectedSquare) {\n      return;\n    }\n    if (checkOut === selectedSquare.checkOut) {\n      return selectedSquare.checkIn;\n    }\n  }\n\n  function getPricePercentile(checkOut: string) {\n    return (checkIn: string): number | undefined => {\n      if (!props.grid) {\n        return;\n      }\n      const thisSquare = props.grid.map.get(datesToKey({ checkIn, checkOut }));\n      if (thisSquare !== undefined) {\n        return (thisSquare.rank - 1) / (props.grid.map.size - 1);\n      }\n    };\n  }\n};\n","import { List as ImmutableList } from \"immutable\";\nimport {\n  PriceGridData,\n  Hotel,\n  PricePoint,\n  PricePointWithPrice,\n  StayDates\n} from \"./types\";\n\nexport interface MatrixState {\n  pricePoints: {\n    byDates?: Map<string, PricePointWithPrice[]>;\n    byHotel: Map<string, PricePoint[]>;\n  };\n  grid?: PriceGridData;\n  hotels: ImmutableList<Hotel>;\n  selectedSquare?: StayDates;\n}\n\nexport interface LoadPricesAction {\n  type: \"LOAD_PRICES\";\n  grid: PriceGridData;\n  pricePointsByDates: Map<string, PricePointWithPrice[]>;\n}\n\nexport interface ToggleHotelSelection {\n  type: \"TOGGLE_HOTEL_SELECTION\";\n  hotel: Hotel;\n}\nexport interface SelectSquareAction {\n  type: \"SELECT_SQUARE\";\n  square: StayDates;\n}\n\nexport type Action =\n  | LoadPricesAction\n  | SelectSquareAction\n  | ToggleHotelSelection;\n\nexport function matrixReducer(state: MatrixState, action: Action): MatrixState {\n  switch (action.type) {\n    case \"LOAD_PRICES\":\n      return {\n        ...state,\n        grid: action.grid,\n        pricePoints: {\n          ...state.pricePoints,\n          byDates: action.pricePointsByDates\n        }\n      };\n    case \"SELECT_SQUARE\":\n      return {\n        ...state,\n        selectedSquare: action.square\n      };\n    case \"TOGGLE_HOTEL_SELECTION\":\n      return {\n        ...state,\n        hotels: state.hotels.map(hotel => ({\n          ...hotel,\n          selected:\n            hotel.name === action.hotel.name ? !hotel.selected : hotel.selected\n        }))\n      };\n  }\n}\n","import React, { useState } from \"react\";\nimport { NumberRange, RangeSlider, IRangeSliderProps } from \"@blueprintjs/core\";\nimport \"./Slider.scss\";\n\ninterface Props extends IRangeSliderProps {\n  value: NumberRange;\n  labelSuffix?: string;\n}\n\nexport const Slider: React.FC<Props> = (props: Props) => {\n  const [localValue, setLocalValue] = useState<NumberRange>(props.value);\n  const { value, labelSuffix, ...spreadableProps } = props;\n  return (\n    <div>\n      <RangeSlider\n        className=\"slider\"\n        labelRenderer={label => (\n          <span className=\"no-wrap\">\n            {label.toLocaleString() + (labelSuffix || \"\")}\n          </span>\n        )}\n        labelStepSize={1}\n        stepSize={0.1}\n        {...spreadableProps}\n        value={localValue}\n        onChange={onChange}\n        onRelease={onRelease}\n      />\n    </div>\n  );\n\n  function onRelease(value: NumberRange) {\n    setLocalValue(value);\n    props.onRelease && props.onRelease(value);\n  }\n\n  function onChange(value: NumberRange) {\n    setLocalValue(value);\n    props.onChange && props.onChange(value);\n  }\n};\n","import React, { Fragment, useState } from \"react\";\nimport { Hotel, Bucket } from \"./types\";\nimport { Slider } from \"./Slider\";\nimport {\n  Tooltip,\n  Checkbox,\n  NumberRange,\n  Collapse,\n  Icon,\n  Intent\n} from \"@blueprintjs/core\";\nimport { DateRangeInput, DateRange } from \"@blueprintjs/datetime\";\nimport { stringToDate, hotelIsWithinDistance } from \"./utils\";\nimport { Set as ImmutableSet } from \"immutable\";\nimport \"./Filters.scss\";\nimport { IconNames } from \"@blueprintjs/icons\";\n\ninterface Props {\n  bucketedHotels: Bucket<Hotel>[];\n  onChangeDateRange: (newRange: DateRange) => void;\n  onChangeDistanceRange: (newRange: NumberRange) => void;\n  onChangeStayLengthRange: (newRange: NumberRange) => void;\n  onChangeHotelSelection: (hotel: Hotel) => void;\n\n  selectedDistanceRange: NumberRange;\n  maxDistance: number;\n\n  selectedStayLengthRange: NumberRange;\n  maxStayLength: number;\n\n  dateRange: DateRange;\n}\n\nexport const Filters: React.FC<Props> = (props: Props) => {\n  const [expandedBuckets, setExpandedBuckets] = useState<ImmutableSet<number>>(\n    ImmutableSet([props.bucketedHotels[0].ceiling])\n  );\n\n  return (\n    <div className=\"filters\">\n      <h3>Filters</h3>\n      <p>Distance from Georgetown</p>\n      <Slider\n        min={0}\n        max={props.maxDistance}\n        value={props.selectedDistanceRange}\n        onRelease={props.onChangeDistanceRange}\n        labelStepSize={5}\n        labelSuffix=\"mi\"\n      />\n      <p className=\"stay-length\">Stay Length</p>\n      <Slider\n        value={props.selectedStayLengthRange}\n        min={1}\n        max={props.maxStayLength}\n        stepSize={1}\n        labelStepSize={2}\n        labelSuffix=\" days\"\n        onRelease={props.onChangeStayLengthRange}\n      />\n      <div className=\"date-range-container\">\n        <DateRangeInput\n          className=\"date-range\"\n          shortcuts={false}\n          formatDate={date => date.toDateString()}\n          parseDate={stringToDate}\n          minDate={props.dateRange[0]}\n          maxDate={props.dateRange[1]}\n          onChange={props.onChangeDateRange}\n        />\n      </div>\n      <div className=\"hotels\">\n        {props.bucketedHotels.map(bucket => (\n          <Fragment key={`${bucket.ceiling}`}>\n            {renderTitle(bucket)}\n            <Collapse isOpen={expandedBuckets.has(getKeyFromBucket(bucket))}>\n              {bucket.items.map(hotel => {\n                const outOfRange = !hotelIsWithinDistance(\n                  hotel,\n                  props.selectedDistanceRange\n                );\n                return (\n                  <div key={hotel.name}>\n                    <Tooltip\n                      content=\"Hotel is not in the selected distance range\"\n                      disabled={!outOfRange}\n                    >\n                      <Checkbox\n                        checked={hotel.selected && !outOfRange}\n                        disabled={outOfRange}\n                        onChange={() => props.onChangeHotelSelection(hotel)}\n                        key={hotel.name}\n                        labelElement={\n                          <span className=\"hotel-name\">\n                            {hotel.name}\n                            <span className=\"distance\">{hotel.distance}mi</span>\n                          </span>\n                        }\n                      />\n                    </Tooltip>\n                  </div>\n                );\n              })}\n            </Collapse>\n          </Fragment>\n        ))}\n      </div>\n    </div>\n  );\n\n  function renderTitle(bucket: Bucket<Hotel>) {\n    const expanded = expandedBuckets.has(getKeyFromBucket(bucket));\n    return (\n      <>\n        <h4 className=\"clickable\" onClick={toggleBucketExpansion(bucket)}>\n          <Icon\n            icon={expanded ? IconNames.CARET_DOWN : IconNames.CARET_RIGHT}\n          />\n          {renderBucketTitle(bucket)}\n          {bucket.items.some(hotel => hotel.selected) && (\n            <Icon\n              className=\"selected-icon\"\n              icon={IconNames.TICK}\n              intent={Intent.SUCCESS}\n            />\n          )}\n        </h4>\n      </>\n    );\n  }\n\n  function renderBucketTitle(bucket: Bucket<Hotel>) {\n    const suffix = \"miles\";\n    if (bucket.ceiling === Infinity) {\n      return `${bucket.floor}+ ${suffix}`;\n    }\n    return `${bucket.floor} – ${bucket.ceiling} ${suffix}`;\n  }\n\n  function toggleBucketExpansion(bucket: Bucket<Hotel>) {\n    const key = getKeyFromBucket(bucket);\n    return () => {\n      setExpandedBuckets(\n        expandedBuckets.has(key)\n          ? expandedBuckets.remove(key)\n          : expandedBuckets.add(key)\n      );\n    };\n  }\n\n  function getKeyFromBucket(bucket: Bucket<Hotel>) {\n    return bucket.ceiling;\n  }\n};\n","import { Classes, NumberRange } from \"@blueprintjs/core\";\nimport { List as ImmutableList } from \"immutable\";\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useState\n} from \"react\";\nimport { AvailableRooms } from \"./AvailableRooms\";\nimport { PriceGrid } from \"./PriceGrid\";\nimport \"./MarriottMatrix.scss\";\nimport { matrixReducer, MatrixState } from \"./matrixReducer\";\nimport {\n  Bucket,\n  Hotel,\n  PriceGridMap,\n  PricePoint,\n  PricePointWithPrice,\n  StayDates\n} from \"./types\";\nimport {\n  datesToKey,\n  DEFAULT_HOTELS,\n  getLast,\n  hotelIsWithinDistance,\n  dateIsInRange,\n  PricePointMap,\n  pricePointIsWithinStayLengthRange,\n  getStayLength,\n  stringToDate,\n  getBucketCeiling\n} from \"./utils\";\nimport { Filters } from \"./Filters\";\nimport { DateRange } from \"@blueprintjs/datetime\";\nimport classNames from \"classnames\";\n\nfunction sortDates(dates: Set<string>): string[] {\n  return Array.from(dates).sort();\n}\n\ninterface Props {\n  pricePoints: PricePoint[];\n}\n\nfunction createInitialState(props: Props): MatrixState {\n  const hotelToPricePoints = new PricePointMap();\n  const selectedHotelNames = new Set<string>();\n  const hotels: Hotel[] = [];\n  props.pricePoints.forEach(pricePoint => {\n    const name = pricePoint.hotelName;\n\n    hotelToPricePoints.addPricePoint(name, pricePoint);\n\n    if (!selectedHotelNames.has(name)) {\n      selectedHotelNames.add(name);\n      hotels.push({\n        name: name,\n        distance: pricePoint.distance,\n        selected: DEFAULT_HOTELS.includes(name)\n      });\n    }\n  });\n\n  hotels.sort((a, b) => a.distance - b.distance);\n\n  return {\n    pricePoints: {\n      byHotel: hotelToPricePoints\n    },\n    hotels: ImmutableList(hotels)\n  };\n}\n\nexport const MarriottMatrix: React.FC<Props> = (props: Props) => {\n  const [viewingAvailableRooms, setViewingAvailableRooms] = useState(false);\n\n  const [state, dispatch] = useReducer(\n    matrixReducer,\n    createInitialState(props)\n  );\n\n  const [bucketedHotels, nameToHotel, anyHotelsSelected] = useMemo(() => {\n    const hotels = state.hotels;\n    const buckets: Bucket<Hotel>[] = [];\n    const nameToHotel = new Map<string, Hotel>();\n    let anyHotelsSelected = false;\n\n    hotels.forEach(hotel => {\n      nameToHotel.set(hotel.name, hotel);\n      anyHotelsSelected = anyHotelsSelected || hotel.selected;\n      if (\n        buckets.length === 0 ||\n        hotel.distance > buckets[buckets.length - 1].ceiling\n      ) {\n        buckets.push({\n          floor: buckets.length === 0 ? 0 : buckets[buckets.length - 1].ceiling,\n          ceiling: getBucketCeiling(hotel.distance),\n          items: [hotel]\n        });\n      } else {\n        getLast(buckets).items.push(hotel);\n      }\n    });\n\n    return [buckets, nameToHotel, anyHotelsSelected];\n  }, [state.hotels]);\n\n  const onSelectSquare = useCallback(\n    (square: StayDates) => {\n      setViewingAvailableRooms(true);\n      dispatch({\n        type: \"SELECT_SQUARE\",\n        square\n      });\n    },\n    [setViewingAvailableRooms, dispatch]\n  );\n\n  const [minDate, maxDate, maxStayLength] = useMemo(() => {\n    let minDate = props.pricePoints[0].stayDates.checkIn;\n    let maxDate = props.pricePoints[0].stayDates.checkOut;\n    let maxStayLength = 1;\n    props.pricePoints.forEach(pricePoint => {\n      const { checkIn, checkOut } = pricePoint.stayDates;\n      if (checkIn < minDate) {\n        minDate = checkIn;\n      }\n      if (checkOut > maxDate) {\n        maxDate = checkOut;\n      }\n\n      const stayLength = getStayLength(pricePoint.stayDates);\n      maxStayLength = Math.max(stayLength, maxStayLength);\n    });\n    return [minDate, maxDate, maxStayLength];\n  }, [props.pricePoints]);\n\n  const maxDistance = useMemo(\n    () => state.hotels.last({ distance: 5 }).distance,\n    [state.hotels]\n  );\n\n  const [distanceRange, setDistanceRange] = useState<NumberRange>([\n    0,\n    maxDistance\n  ]);\n  const [dateRange, setDateRange] = useState<DateRange>([\n    stringToDate(minDate),\n    stringToDate(maxDate)\n  ]);\n  const [stayLengthRange, setStayLengthRange] = useState<NumberRange>([\n    1,\n    maxStayLength\n  ]);\n\n  useEffect(() => {\n    const datesToPricePoints = new PricePointMap<PricePointWithPrice>();\n    const priceGridMap = new Map<string, PricePointWithPrice>();\n    const checkInDates = new Set<string>();\n    const checkOutDates = new Set<string>();\n\n    function addPricePointToGrid(pricePoint: PricePoint) {\n      const {\n        hotelName,\n        pricePerNight,\n        soldOut,\n        stayDates: { checkIn, checkOut }\n      } = pricePoint;\n\n      for (const date of [checkIn, checkOut]) {\n        if (!dateIsInRange(date, dateRange)) {\n          return;\n        }\n      }\n\n      checkInDates.add(checkIn);\n      checkOutDates.add(checkOut);\n\n      const hotel = nameToHotel.get(hotelName);\n      if (\n        !hotel ||\n        (anyHotelsSelected && !hotel.selected) ||\n        !hotelIsWithinDistance(hotel, distanceRange) ||\n        !pricePointIsWithinStayLengthRange(\n          pricePoint.stayDates,\n          stayLengthRange\n        )\n      ) {\n        return;\n      }\n\n      if (pricePerNight === null || pricePerNight === undefined || soldOut) {\n        return;\n      }\n\n      const pricePointWithPrice = {\n        ...pricePoint,\n        pricePerNight\n      };\n      const datesString = datesToKey({ checkIn, checkOut });\n      const bestPriceForStay = priceGridMap.get(datesString);\n      if (!bestPriceForStay || pricePerNight < bestPriceForStay.pricePerNight) {\n        priceGridMap.set(datesString, pricePointWithPrice);\n      }\n      datesToPricePoints.addPricePoint(datesString, pricePointWithPrice);\n    }\n\n    if (anyHotelsSelected) {\n      for (const [\n        hotelName,\n        pricePoints\n      ] of state.pricePoints.byHotel.entries()) {\n        const hotelForPricePoint = nameToHotel.get(hotelName);\n        if (\n          hotelForPricePoint &&\n          hotelForPricePoint.selected &&\n          hotelIsWithinDistance(hotelForPricePoint, distanceRange)\n        ) {\n          pricePoints.forEach(pricePoint => {\n            if (\n              pricePointIsWithinStayLengthRange(\n                pricePoint.stayDates,\n                stayLengthRange\n              )\n            ) {\n              addPricePointToGrid(pricePoint);\n            }\n          });\n        }\n      }\n    } else {\n      props.pricePoints.forEach(addPricePointToGrid);\n    }\n\n    // add ranks\n    const sortedPrices = [...priceGridMap.entries()].sort(\n      ([_, a], [__, b]) => a.pricePerNight - b.pricePerNight\n    );\n    const mapWithRanks: PriceGridMap = new Map();\n    sortedPrices.forEach(([dateString, _], i) => {\n      const pricePoint = priceGridMap.get(dateString);\n      if (pricePoint) {\n        mapWithRanks.set(dateString, {\n          ...pricePoint,\n          rank: i + 1\n        });\n      }\n    });\n\n    dispatch({\n      type: \"LOAD_PRICES\",\n      pricePointsByDates: datesToPricePoints,\n      grid: {\n        map: mapWithRanks,\n        checkInDates: sortDates(checkInDates),\n        checkOutDates: sortDates(checkOutDates)\n      }\n    });\n  }, [\n    props.pricePoints,\n    state.hotels,\n    dateRange,\n    distanceRange,\n    stayLengthRange,\n    anyHotelsSelected,\n    nameToHotel,\n    state.pricePoints.byHotel\n  ]);\n\n  return (\n    <div className={classNames(\"container\", Classes.DARK)}>\n      <div className=\"sidebar\">{renderFilters()}</div>\n      <div className=\"content\">\n        <h2>Marriott Matrix</h2>\n        {renderTable()}\n        <AvailableRooms\n          selectedSquare={state.selectedSquare}\n          pricePoints={getPricePointsForStay(state.selectedSquare)}\n          visible={viewingAvailableRooms}\n          onClose={() => setViewingAvailableRooms(false)}\n        />\n      </div>\n    </div>\n  );\n\n  function renderTable() {\n    if (!state.grid) {\n      return null;\n    }\n    return (\n      <PriceGrid\n        grid={state.grid}\n        dateRange={dateRange}\n        useBlueprintTable={false}\n        onSelectSquare={onSelectSquare}\n      />\n    );\n  }\n\n  function renderFilters() {\n    if (!state.grid) {\n      return null;\n    }\n    return (\n      <Filters\n        dateRange={[stringToDate(minDate), stringToDate(maxDate)]}\n        onChangeDateRange={setDateRange}\n        maxDistance={maxDistance}\n        selectedDistanceRange={distanceRange}\n        onChangeDistanceRange={setDistanceRange}\n        maxStayLength={maxStayLength}\n        selectedStayLengthRange={stayLengthRange}\n        onChangeStayLengthRange={setStayLengthRange}\n        bucketedHotels={bucketedHotels}\n        onChangeHotelSelection={hotel => {\n          dispatch({\n            type: \"TOGGLE_HOTEL_SELECTION\",\n            hotel\n          });\n        }}\n      />\n    );\n  }\n\n  function getPricePointsForStay(\n    stay?: StayDates\n  ): PricePointWithPrice[] | undefined {\n    if (!state.grid || !stay || !state.pricePoints.byDates) {\n      return [];\n    }\n    return state.pricePoints.byDates.get(datesToKey(stay));\n  }\n};\n","import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport { MarriottMatrix } from \"./MarriottMatrix\";\nimport prices from \"./prices.json\";\nimport { ScrapedPricePoint, PricePoint } from \"./types\";\nimport moment from \"moment\";\n\nfunction useWindowWidth() {\n  const [width, setWidth] = useState(window.innerWidth);\n\n  useEffect(() => {\n    const handleResize = () => setWidth(window.innerWidth);\n    window.addEventListener(\"resize\", handleResize);\n    return () => {\n      window.removeEventListener(\"resize\", handleResize);\n    };\n  });\n\n  return width;\n}\n\nfunction processScrapedPricePoint(pricePoint: ScrapedPricePoint): PricePoint {\n  const [checkIn, checkOut] = pricePoint.dates;\n\n  // TODO: url generation should be on backend\n  let bookingLink: string | undefined = undefined;\n  if (pricePoint.booking_link) {\n    const propertyCodeMatch = pricePoint.booking_link.match(\n      /propertyCode=([A-Z]+)&/\n    );\n    if (propertyCodeMatch === null) {\n      throw Error(\n        \"No property code match in booking link: \" + pricePoint.booking_link\n      );\n    }\n    const propertyCode = propertyCodeMatch[1];\n\n    bookingLink =\n      \"https://www.marriott.com/reservation/availabilitySearch.mi?&propertyCode=\" +\n      propertyCode +\n      \"&fromDate=\" +\n      moment(checkIn).format(\"MM/DD/YYYY\") +\n      \"&toDate=\" +\n      moment(checkOut).format(\"MM/DD/YYYY\") +\n      \"&numberOfRooms=1&numberOfGuests=1&currency=USD\";\n\n    if (pricePoint.corporate_rate) {\n      bookingLink += \"&clusterCode=corp&corporateCode=P5R\";\n    }\n  }\n\n  return {\n    hotelName: pricePoint.name,\n    stayDates: { checkIn, checkOut },\n    corporateRate: pricePoint.corporate_rate,\n    pricePerNight: pricePoint.price_per_night,\n    soldOut: pricePoint.sold_out,\n    distance: pricePoint.distance,\n    bookingLink\n  };\n}\n\nconst App: React.FC = () => {\n  const width = useWindowWidth();\n  if (width < 1000) {\n    return <p className=\"too-small\">Desktop only :-)</p>;\n  }\n  return <MarriottMatrix pricePoints={prices.map(processScrapedPricePoint)} />;\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}